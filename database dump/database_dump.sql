--------------------------------------------------------
--  DDL for Table USUARIOS, PRODUCTOS, ORDENES
--------------------------------------------------------

  CREATE TABLE "SYSTEM"."USUARIOS" 
   (	"ID_USUARIO" NUMBER, 
        "USUARIO" VARCHAR2(20 BYTE), 
        "NOMBRE" VARCHAR2(100 BYTE), 
        "CLAVE" VARCHAR2(20 BYTE), 
        "PERFIL" VARCHAR2(20 BYTE)
   ) PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
  
  CREATE TABLE "SYSTEM"."PRODUCTOS" 
   (	"ID_PRODUCTO" NUMBER, 
        "NOMBRE_PRODUCTO" VARCHAR2(50 BYTE), 
        "CANTIDAD_PORCIONES" NUMBER, 
        "DESCRIPCION" VARCHAR2(100 BYTE), 
        "PRECIO" NUMBER, 
        "TAMAÑO" VARCHAR2(20 BYTE)
   ) PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;

  CREATE TABLE "SYSTEM"."ORDENES" 
   (	"ID_ORDEN" NUMBER, 
	"NOMBRE_CLIENTE" VARCHAR2(100 BYTE), 
	"ID_PRODUCTO" NUMBER, 
	"CANTIDAD" NUMBER, 
	"FECHA_PEDIDO" DATE, 
	"DIRECCION" VARCHAR2(100 BYTE), 
	"COMENTARIOS" VARCHAR2(100 BYTE), 
	"ESTADO" VARCHAR2(20 BYTE), 
	"USUARIO" VARCHAR2(20 BYTE)
   ) PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;  
  
--------------------------------------------------------
--  DDL for Index USUARIOS_UK
--------------------------------------------------------

  CREATE UNIQUE INDEX "SYSTEM"."USUARIOS_UK" ON "SYSTEM"."USUARIOS" ("USUARIO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE( INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
  ALTER INDEX "SYSTEM"."USUARIOS_UK"  UNUSABLE;
--------------------------------------------------------
--  DDL for Index USUARIOS_PK, PRODUCTOS_PK, ORDENES_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "SYSTEM"."USUARIOS_PK" ON "SYSTEM"."USUARIOS" ("ID_USUARIO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE( INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
  ALTER INDEX "SYSTEM"."USUARIOS_PK"  UNUSABLE;
  
  CREATE UNIQUE INDEX "SYSTEM"."PRODUCTOS_PK" ON "SYSTEM"."PRODUCTOS" ("ID_PRODUCTO") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE( INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;
  ALTER INDEX "SYSTEM"."PRODUCTOS_PK"  UNUSABLE;
  
  CREATE UNIQUE INDEX "SYSTEM"."ORDENES_PK" ON "SYSTEM"."ORDENES" ("ID_ORDEN") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM" ;  

-------------------------------------------------------------
--  DDL for Sequence USUARIOS_SEQ, PRODUCTOS_SEQ, ORDENES_SEQ
-------------------------------------------------------------

   CREATE SEQUENCE  "SYSTEM"."USUARIOS_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  GLOBAL ;
   ALTER SEQUENCE "SYSTEM"."USUARIOS_SEQ" INCREMENT BY 20;
   CREATE SEQUENCE  "SYSTEM"."PRODUCTOS_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  GLOBAL ;
   ALTER SEQUENCE "SYSTEM"."PRODUCTOS_SEQ" INCREMENT BY 20;
   CREATE SEQUENCE  "SYSTEM"."ORDENES_SEQ"  MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  GLOBAL ;
   ALTER SEQUENCE "SYSTEM"."ORDENES_SEQ" INCREMENT BY 20;

------------------------------------------------------------
--  DDL for Trigger USUARIOS_TRG, PRODUCTOS_TRG, ORDENES_TRG
------------------------------------------------------------

  CREATE OR REPLACE NONEDITIONABLE TRIGGER "SYSTEM"."USUARIOS_TRG" 
BEFORE INSERT ON USUARIOS 
FOR EACH ROW 
BEGIN
  <<COLUMN_SEQUENCES>>
  BEGIN
    IF INSERTING AND :NEW.ID_USUARIO IS NULL THEN
      SELECT USUARIOS_SEQ.NEXTVAL INTO :NEW.ID_USUARIO FROM SYS.DUAL;
    END IF;
  END COLUMN_SEQUENCES;
END;
/
ALTER TRIGGER "SYSTEM"."USUARIOS_TRG" ENABLE;

  CREATE OR REPLACE NONEDITIONABLE TRIGGER "SYSTEM"."PRODUCTOS_TRG" 
BEFORE INSERT ON PRODUCTOS 
FOR EACH ROW 
BEGIN
  <<COLUMN_SEQUENCES>>
  BEGIN
    NULL;
  END COLUMN_SEQUENCES;
END;
/
ALTER TRIGGER "SYSTEM"."PRODUCTOS_TRG" ENABLE;

  CREATE OR REPLACE NONEDITIONABLE TRIGGER "SYSTEM"."ORDENES_TRG" 
BEFORE INSERT ON ORDENES 
FOR EACH ROW 
BEGIN
  <<COLUMN_SEQUENCES>>
  BEGIN
    IF INSERTING AND :NEW.ID_ORDEN IS NULL THEN
      SELECT ORDENES_SEQ.NEXTVAL INTO :NEW.ID_ORDEN FROM SYS.DUAL;
    END IF;
  END COLUMN_SEQUENCES;
END;
/
ALTER TRIGGER "SYSTEM"."ORDENES_TRG" ENABLE;
--------------------------------------------------------
--  Constraints for Table USUARIOS, PRODUCTOS, ORDENES
--------------------------------------------------------

  ALTER TABLE "SYSTEM"."USUARIOS" MODIFY ("ID_USUARIO" NOT NULL ENABLE);
  ALTER TABLE "SYSTEM"."USUARIOS" MODIFY ("USUARIO" NOT NULL ENABLE);
  ALTER TABLE "SYSTEM"."USUARIOS" MODIFY ("NOMBRE" NOT NULL ENABLE);
  ALTER TABLE "SYSTEM"."USUARIOS" MODIFY ("CLAVE" NOT NULL ENABLE);
  ALTER TABLE "SYSTEM"."USUARIOS" MODIFY ("PERFIL" NOT NULL ENABLE);
  ALTER TABLE "SYSTEM"."USUARIOS" ADD CONSTRAINT "USUARIOS_UK" UNIQUE ("USUARIO")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE( INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
  ALTER TABLE "SYSTEM"."USUARIOS" ADD CONSTRAINT "USUARIOS_PK" PRIMARY KEY ("ID_USUARIO")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE( INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
  
  ALTER TABLE "SYSTEM"."PRODUCTOS" MODIFY ("ID_PRODUCTO" NOT NULL ENABLE);
  ALTER TABLE "SYSTEM"."PRODUCTOS" MODIFY ("NOMBRE_PRODUCTO" NOT NULL ENABLE);
  ALTER TABLE "SYSTEM"."PRODUCTOS" MODIFY ("CANTIDAD_PORCIONES" NOT NULL ENABLE);
  ALTER TABLE "SYSTEM"."PRODUCTOS" MODIFY ("DESCRIPCION" NOT NULL ENABLE);
  ALTER TABLE "SYSTEM"."PRODUCTOS" MODIFY ("PRECIO" NOT NULL ENABLE);
  ALTER TABLE "SYSTEM"."PRODUCTOS" MODIFY ("TAMAÑO" NOT NULL ENABLE);
  ALTER TABLE "SYSTEM"."PRODUCTOS" ADD CONSTRAINT "PRODUCTOS_PK" PRIMARY KEY ("ID_PRODUCTO")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE( INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
  
  ALTER TABLE "SYSTEM"."ORDENES" MODIFY ("ID_ORDEN" NOT NULL ENABLE);
  ALTER TABLE "SYSTEM"."ORDENES" MODIFY ("NOMBRE_CLIENTE" NOT NULL ENABLE);
  ALTER TABLE "SYSTEM"."ORDENES" MODIFY ("ID_PRODUCTO" NOT NULL ENABLE);
  ALTER TABLE "SYSTEM"."ORDENES" MODIFY ("CANTIDAD" NOT NULL ENABLE);
  ALTER TABLE "SYSTEM"."ORDENES" MODIFY ("FECHA_PEDIDO" NOT NULL ENABLE);
  ALTER TABLE "SYSTEM"."ORDENES" MODIFY ("ESTADO" NOT NULL ENABLE);
  ALTER TABLE "SYSTEM"."ORDENES" MODIFY ("USUARIO" NOT NULL ENABLE);
  ALTER TABLE "SYSTEM"."ORDENES" ADD CONSTRAINT "ORDENES_PK" PRIMARY KEY ("ID_ORDEN")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SYSTEM"  ENABLE;
  
--------------------------------------------------------
--  Ref Constraints for Table ORDENES
--------------------------------------------------------

  ALTER TABLE "SYSTEM"."ORDENES" ADD CONSTRAINT "ORDENES_FK" FOREIGN KEY ("ID_PRODUCTO")
	  REFERENCES "SYSTEM"."PRODUCTOS" ("ID_PRODUCTO") ENABLE;
  
 --------------------------------------------------------
--  Data for Table ORDENES
-------------------------------------------------------- 

INSERT INTO SYSTEM.USUARIOS (ID_USUARIO,USUARIO,NOMBRE,CLAVE,PERFIL) VALUES (1,'login','Empleado','login','Empleado');
INSERT INTO SYSTEM.USUARIOS (ID_USUARIO,USUARIO,NOMBRE,CLAVE,PERFIL) VALUES (2,'admin','Administrador','admin','Administrador');
